<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="汝还白汝天子，我承人乏，为中国所推，已为帝矣。">
    <meta name="keyword"  content="李永会,李郞小汇,机器学习,移动端,GPU">
    <link rel="shortcut icon" href="/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <title>
        
          chapter-03-bitmap-and-background-threads - 李郞小汇
        
    </title>

    <link rel="canonical" href="http://www.allonli.com/2016/02/22/chapter-03-bitmap-and-background-threads/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS --> 
    <link rel="stylesheet" href="/css/hux-blog.min.css">
    
    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css">

    <link rel="stylesheet" href="/css/widget.css">

    <link rel="stylesheet" href="/css/rocket.css">

    <link rel="stylesheet" href="/css/signature.css">

    <link rel="stylesheet" href="/css/toc.css">

    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!--allonli add-->
    <style type=text/css>
	.at_img img{max-width:70%;}
    </style>

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
	<!-- Modified by Yu-Hsuan Yen -->
<!-- math katex Header -->
<link href="https://cdn.bootcss.com/KaTeX/0.7.1/katex.min.css" rel="stylesheet">
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('/img/06.jpg')
            /*post*/
        
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#android" title="android">android</a>
                            
                        </div>
                        <h1>chapter-03-bitmap-and-background-threads</h1>
                        <h2 class="subheading"></h2>
                        <span class="meta">
                            Posted by allon li on
                            2016-02-22
                        </span>
                    </div>
                


                </div>
            </div>
        </div>
    </div>
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">李郞小汇</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">首页</a>
                    </li>

                    
                        
                        <li>
                            <a href="/about/">关于</a>
                        </li>
                        
                    
                        
                        <li>
                            <a href="/archive/">文章</a>
                        </li>
                        
                    
                        
                        <li>
                            <a href="/tags/">分类</a>
                        </li>
                        
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Modify by Yu-Hsuan Yen -->

<!-- Post Content -->
<article class="at_img">
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <h1><span id="chapter-03-bitmap-and-background-threads"> chapter-03-bitmap-and-background-threads</span></h1>
<p>Tags:Training-for-Android-developers</p>
<hr>
<h2><span id="位图bitmap"> 位图（Bitmap）</span></h2>
<p>和Drawable的区别：一个Bitmap对象是一张bitmap格式图片的表示(类似于Java.awt.image）。一个Drawable对象是“那些能够在其上面画的任意对象”，它也许是一个bitmap对象，也可能是一个solid color、一个其他Drawable对象的集合。 大多数Android UI框架喜欢用Drawable对象，而不是Bitmap对象。一个View可以接受任何Drawable对象作为background。</p>
<blockquote>
<ul>
<li>Mobile devices typically have constrained system resources. Android devices can have as little as 16MB of memory available to a single application. The Android Compatibility Definition Document (CDD), Section 3.7. Virtual Machine Compatibility gives the required minimum application memory for various screen sizes and densities. Applications should be optimized to perform under this minimum memory limit. However, keep in mind many devices are configured with higher limits.</li>
</ul>
</blockquote>
<p>Android设备为每个app分配16MB的内存空间，虽然厂商会更改rom，定制更高的单个App内存空间，但是开发者应该依据最小的内存限制即16MB控制内存开销。</p>
<blockquote>
<ul>
<li>Android设备屏幕大小不一，分辨率各不相同。如果在UI中需要加载一副大图片，明智的做法是先获取屏幕的分辨率，然后再决定加载图片的大小。在一款低分辨率的设备上加载高分辨率图片除了增加内存消耗，别无他用。因为设备最大能展示的清晰度为本身的屏幕分辨率。所以，如果一个不需要放大图片的控件需要加载图片，最大只需要加载该控件本身宽高的图片即可。</li>
</ul>
</blockquote>
<p>BitmapFactory提供了一些解码（decode）的方法（decodeByteArray(), decodeFile(), decodeResource()等），用来从不同的资源中创建一个Bitmap。</p>
<p>设置 inJustDecodeBounds 属性为true可以在解码的时候避免内存的分配，它会返回一个null的Bitmap，但是可以获取到 outWidth, outHeight 与 outMimeType。这样可以允许你在构造Bitmap之前优先读图片的尺寸与类型。</p>
<blockquote>
<ul>
<li>BitmapFactory.Options 中设置 inSampleSize 的值。例如, 一个分辨率为2048x1536的图片，如果设置 inSampleSize 为4，那么会产出一个大约512x384大小的Bitmap。大小只是原来的1/16。</li>
</ul>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Calculate inSampleSize</span></span><br><span class="line">options.inSampleSize = calculateInSampleSize(options, reqWidth, reqHeight);</span><br></pre></td></tr></table></figure>
<p>在处理图片时，一般防止图将主线程卡住。一般会使用AsyncTask，将处理图片的过程放到单独的线程中处理。使用弱、软引用时，要注意到目前的虚拟机中GC的频率很高，在API LEVEL 11以前bitmap是放到native内存中，这样被回收后的状态是不可预知的，可能会产生crash。所以要慎重使用这两种引用方式。</p>
<p>使用缓存是处理图片时的常用方式，一般分为两种方式，内存缓存可以使用LruCache（本质就是一个LinkedHashMap）。也可以使用DiskLruCache。</p>
<h2><span id="android后台任务"> Android后台任务</span></h2>
<h3><span id="intentservice"> IntentService</span></h3>
<blockquote>
<ul>
<li>The IntentService class provides a straightforward structure for running an operation on a single background thread.<br>
IntentService类提供了一个简单的后台单线程的实现。</li>
</ul>
</blockquote>
<p>但是IntentService有下面几个局限性：<br>
An IntentService has a few limitations:</p>
<blockquote>
<ul>
<li>It can’t interact directly with your user interface. To put its results in the UI, you have to send them to an Activity.<br>
不可以直接和UI做交互。为了把他执行的结果体现在UI上，需要把结果返回给Activity。</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>Work requests run sequentially. If an operation is running in an IntentService, and you send it another request, the request waits until the first operation is finished.<br>
工作任务队列是顺序执行的，如果一个任务正在IntentService中执行，此时你再发送一个新的任务请求，这个新的任务会一直等待直到前面一个任务执行完毕才开始执行。</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>An operation ru</li>
</ul>
</blockquote>
<figure class="highlight plain"><figcaption><span>on an IntentService can't be interrupted.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">正在执行的任务无法打断。</span><br><span class="line"></span><br><span class="line">&gt;* **这么一大堆，其实就是在说：这只是一个方便使用的单线程。**</span><br><span class="line"></span><br><span class="line">主线程拉起一个Inservice线程，并和IntentService来来回回没完没了的交互。总（long）共分四步：</span><br><span class="line"></span><br><span class="line">* 建一个IntentService子类，实现里面的回调方法onHandleIntent。</span><br><span class="line">* 在主线程创建一个IntentService子类的对象。并拉起来。</span><br><span class="line">* 建一个Receiver，并实现回调。</span><br><span class="line">* 把Receiver注册上。（把冰箱门关上）</span><br><span class="line"></span><br><span class="line">#### Let&apos;s Go !</span><br><span class="line"></span><br><span class="line">1, 创建一个IntentService class</span><br><span class="line">```xml</span><br><span class="line">&lt;application</span><br><span class="line">    android:icon=&quot;@drawable/icon&quot;</span><br><span class="line">    android:label=&quot;@string/app_name&quot;&gt;</span><br><span class="line">    ...</span><br><span class="line">    &lt;!--</span><br><span class="line">        Because android:exported is set to &quot;false&quot;,</span><br><span class="line">        the service is only available to this app.</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;service</span><br><span class="line">        android:name=&quot;.RSSPullService&quot;</span><br><span class="line">        android:exported=&quot;false&quot;/&gt;</span><br><span class="line">    ...</span><br><span class="line">&lt;application/&gt;</span><br></pre></td></tr></table></figure>
<p>java code</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RSSPullService</span> <span class="keyword">extends</span> <span class="title">IntentService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onHandleIntent</span><span class="params">(Intent workIntent)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Gets data from the incoming Intent</span></span><br><span class="line">        String dataString = workIntent.getDataString();</span><br><span class="line">        <span class="comment">// to do something bala bala...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2, 创建一个具体的Intent对象，并用来启动IntentService。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Creates a new Intent to start the RSSPullService</span></span><br><span class="line"><span class="comment"> * IntentService. Passes a URI in the</span></span><br><span class="line"><span class="comment"> * Intent's "data" field.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">mServiceIntent = <span class="keyword">new</span> Intent(getActivity(), RSSPullService.class);</span><br><span class="line">mServiceIntent.setData(Uri.parse(dataUrl));</span><br><span class="line"><span class="comment">// Let's go!</span></span><br><span class="line">getActivity().startService(mServiceIntent);</span><br></pre></td></tr></table></figure>
<p>3, 如果需要发送数据给主线程</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Intent localIntent = <span class="keyword">new</span> Intent(Constants.BROADCAST_ACTION);</span><br><span class="line"><span class="comment">// Puts the status into the Intent</span></span><br><span class="line">localIntent.putExtra(Constants.EXTENDED_DATA_STATUS, status);</span><br><span class="line">oadcastManager.getInstance(<span class="keyword">this</span>).sendBroadcast(localIntent);</span><br></pre></td></tr></table></figure>
<p>定义主线程接收消息的类，需要一个BroadcastReceiver的子类。并复写onReceive。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Broadcast receiver for receiving status updates from the IntentService</span></span><br><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">ResponseReceiver</span> <span class="keyword">extends</span> <span class="title">BroadcastReceiver</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// Prevents instantiation</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">DownloadStateReceiver</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Called when the BroadcastReceiver gets an Intent it's registered to receive</span></span><br><span class="line">    @</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceive</span><span class="params">(Context context, Intent intent)</span> </span>&#123;</span><br><span class="line">...</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * Handle Intents here.</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4, 即使有了receiver类，如果想要收到子线程发的消息。还要让程序知道，接收什么样的消息，用谁来接收。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 接收什么样的消息</span></span><br><span class="line">IntentFilter statusIntentFilter = <span class="keyword">new</span> IntentFilter(Constants.BROADCAST_ACTION);</span><br><span class="line">statusIntentFilter.addCategory(Intent.CATEGORY_DEFAULT);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用谁来接收（注册receiver）</span></span><br><span class="line">mDownloadStateReceiver = <span class="keyword">new</span> ResponseReceiver();</span><br><span class="line">LocalBroadcastManager.getInstance(<span class="keyword">this</span>).registerReceiver(mDownloadStateReceiver, statusIntentFilter);</span><br></pre></td></tr></table></figure>
<h3><span id="点亮屏幕"> 点亮屏幕</span></h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);</span><br><span class="line"><span class="comment">//清除flag回到正常状态</span></span><br><span class="line">getWindow().clearFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON)</span><br></pre></td></tr></table></figure>
<p>也可以AndroidManifest.xml里定义该属性，由于在AndroidManifest里定义的内容不能动态改变。所以设了就不能反悔。</p>

                

                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/2016/02/22/chapter-04-best-practices-for-memory/" data-toggle="tooltip" data-placement="top" title="chapter-04-best-practices-for-memory">&larr; 上一篇</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/2016/02/22/chapter-02-sharing-and-multimedia/" data-toggle="tooltip" data-placement="top" title="chapter-02-sharing-and-multimedia">下一篇 &rarr;</a>
                        </li>
                    
                </ul>

                <!-- duoshuo Share start -->
                
                <!-- 多说 Share end-->

                <!-- 多说评论框 start -->
                
                <!-- 多说评论框 end -->

                <!-- disqus comment start -->
                
                <!-- disqus comment end -->
            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#undefined"><span class="toc-nav-number">1.</span> <span class="toc-nav-text"> chapter-03-bitmap-and-background-threads</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#undefined"><span class="toc-nav-number">1.1.</span> <span class="toc-nav-text"> 位图（Bitmap）</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#undefined"><span class="toc-nav-number">1.2.</span> <span class="toc-nav-text"> Android后台任务</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#undefined"><span class="toc-nav-number">1.2.1.</span> <span class="toc-nav-text"> IntentService</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#undefined"><span class="toc-nav-number">1.2.2.</span> <span class="toc-nav-text"> 点亮屏幕</span></a></li></ol></li></ol></li></ol>
        
        </div>
      </aside>
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">分类</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#android" title="android">android</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>友情链接</h5>
                <ul class="list-inline">

                    
                        <li><a href="https://allonli.github.io" target="_blank">blogs</a></li>
                    
                        <li><a href="http://www.allonli.com" target="_blank">allonli.com</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>





<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: ''
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>




    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                
                
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/allon">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                

                

                
                    <li>
                        <a target="_blank" href="https://www.facebook.com/allon517">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank"  href="https://github.com/allonli">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; allon li 2017 
                    <br>
                    Theme by <a href="http://huangxuan.me">Hux</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span> 
                    re-Ported by <a href="http://allonli.com">AllonLi</a> | 
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=allonli&repo=hexo-theme-beantech&type=star&count=false" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("http://www.allonli.com/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-XXXXXXXX-X';
    var _gaDomain = 'www.allonli.com';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->




	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>
<!-- Image to hack wechat -->
<img src="http://www.allonli.com/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
